{"version":3,"sources":["../src/cli.ts"],"sourcesContent":["#!/bin/env node\r\n\r\nimport { program } from \"commander\";\r\nimport * as steam from \"./steam.js\";\r\nimport * as gmad from \"./gmad.js\";\r\n\r\ninterface ProgramOptions {\r\n    username: string;\r\n\r\n    password?: string;\r\n    totp?: string;\r\n    vdf?: string;\r\n\r\n    id?: string;\r\n\r\n    icon?: string;\r\n    title?: string;\r\n    description?: string;\r\n\r\n    changelog?: string;\r\n    folder: string;\r\n}\r\n\r\nasync function run() {\r\n    const command = await program\r\n        .name('workshop-upload')\r\n        .requiredOption('-u, --username <username>', 'Steam username', process.env.STEAM_USERNAME)\r\n        .option('-p, --password <password>', 'Steam password', process.env.STEAM_PASSWORD)\r\n        .option('--totp <totp>', 'Steam TOTP code', process.env.STEAM_TOTP)\r\n        .option('--vdf <vdf>', 'Steam account VDF', process.env.STEAM_VDF)\r\n        .option('-i, --id <id>', 'Addon ID', process.env.ADDON_ID)\r\n        .option('--changelog <changelog>', 'Addon changelog', process.env.ADDON_CHANGELOG)\r\n        .option('--icon <icon>', 'Addon icon', process.env.ADDON_ICON)\r\n        .option('--title <title>', 'Addon title', process.env.ADDON_TITLE)\r\n        .option('--description <description>', 'Addon description', process.env.ADDON_DESCRIPTION)\r\n        .requiredOption('--folder <path>', 'Addon directory', process.env.ADDON_DIR)\r\n        .parseAsync(process.argv);\r\n\r\n    const { username, password, totp, vdf, id, changelog, icon, folder: dir, title, description } = command.opts<ProgramOptions>();\r\n\r\n    await steam.download();\r\n    await steam.update();\r\n    await steam.login(username, { password, totp, vdf });\r\n\r\n    await gmad.download();\r\n    const folder = await gmad.create(dir, './output/addon.gma');\r\n\r\n    await steam.publish(username, {\r\n        id,\r\n        appid: \"4000\",\r\n        changelog,\r\n        icon,\r\n        folder,\r\n        title,\r\n        description,\r\n    });\r\n}\r\n\r\nrun();\r\n"],"mappings":";;;;;;;;;;;AAEA,SAAS,eAAe;AAqBxB,eAAe,MAAM;AACjB,QAAM,UAAU,MAAM,QACjB,KAAK,iBAAiB,EACtB,eAAe,6BAA6B,kBAAkB,QAAQ,IAAI,cAAc,EACxF,OAAO,6BAA6B,kBAAkB,QAAQ,IAAI,cAAc,EAChF,OAAO,iBAAiB,mBAAmB,QAAQ,IAAI,UAAU,EACjE,OAAO,eAAe,qBAAqB,QAAQ,IAAI,SAAS,EAChE,OAAO,iBAAiB,YAAY,QAAQ,IAAI,QAAQ,EACxD,OAAO,2BAA2B,mBAAmB,QAAQ,IAAI,eAAe,EAChF,OAAO,iBAAiB,cAAc,QAAQ,IAAI,UAAU,EAC5D,OAAO,mBAAmB,eAAe,QAAQ,IAAI,WAAW,EAChE,OAAO,+BAA+B,qBAAqB,QAAQ,IAAI,iBAAiB,EACxF,eAAe,mBAAmB,mBAAmB,QAAQ,IAAI,SAAS,EAC1E,WAAW,QAAQ,IAAI;AAE5B,QAAM,EAAE,UAAU,UAAU,MAAM,KAAK,IAAI,WAAW,MAAM,QAAQ,KAAK,OAAO,YAAY,IAAI,QAAQ,KAAqB;AAE7H,QAAY,SAAS;AACrB,QAAY,OAAO;AACnB,QAAY,MAAM,UAAU,EAAE,UAAU,MAAM,IAAI,CAAC;AAEnD,QAAWA,UAAS;AACpB,QAAM,SAAS,MAAW,OAAO,KAAK,oBAAoB;AAE1D,QAAY,QAAQ,UAAU;AAAA,IAC1B;AAAA,IACA,OAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACJ,CAAC;AACL;AAEA,IAAI;","names":["download"]}